@model prjShoppingForum.Models.Entity.tUserProfile

@{
    ViewBag.Title = "New";

}


<div class="containers">
    <div class="signup-content" >
        <div class="signup-form">
            <h2 class="form-title">Register</h2>
            <form action="/FrontUserProfile/New" method="post" name="LoginForm" class="register-form" id="register-form">

                <div class="form-group">
                    <label for="email"></label>
                    <input type="email" name="fUserId" id="email" placeholder="Your Email" required/>
                </div>
                @Html.ValidationMessageFor(model => model.fUserId, "", new { @class = "text-danger" })

                <div class="form-group">
                    <label for="name"></label>
                    <input type="text" name="fName" id="name" placeholder="Your Name" required/>
                </div>
                @Html.ValidationMessageFor(model => model.fName, "", new { @class = "text-danger" })


                <div class="form-group">
                    <label for="pass"></label>
                    <input type="password" name="fPassword" id="pass" placeholder="Password" @*data-minlength="6"*@ pattern="^[a-zA-Z0-9]{6,12}" @*maxlength="12"*@ required/>
                </div>
                @Html.ValidationMessageFor(model => model.fPassword, "", new { @class = "text-danger" })

                <div class="form-group">
                    <label for="re-pass"></label>
                    <input type="text" name="fGender" id="Gender" placeholder="Gender" required/>
                </div>
                @Html.ValidationMessageFor(model => model.fGender, "", new { @class = "text-danger" })

                <div class="form-group">
                    <label for="re-pass"></label>
                    <input type="text" name="fPhone" id="Phone" placeholder="Phone" required/>
                </div>
                @Html.ValidationMessageFor(model => model.fPhone, "", new { @class = "text-danger" })


                <div class="form-group form-button">
                    <input type="button" name="userSignUp" id="signup" class="form-submit" value="註冊" />
                    <input type="reset"  class="form-submit" value="取消" />
                </div>
            </form>
        </div>

        <div class="signup-image">
            <figure><img src="~/Images/Member/signup-image.jpg" alt="sing up image"></figure>
            @*<a href="#" class="signup-image-link">I am already member</a>*@
        </div>
    </div>
</div>

<link rel="stylesheet" href="~/Content/material-design-iconic-font.min.css">
<link rel="stylesheet" href="~/Content/SignUpstyle.css">


@section Scripts{
    <script src="~/Scripts/jquery.min.js"></script>
    <script src="~/Scripts/main.js"></script>
    <script>
        var btnCreateUser = document.querySelector('input[name="userSignUp"]');
        var xhr = null;
        btnCreateUser.addEventListener("click", function () {
            document.LoginForm.submit();
        })

        //1.帳號驗證--是否已存在
        var UserIdInput = document.querySelector('#inputUserId');
        var myDiv = document.querySelector('#useridsp');

        var xhr = null;
        UserIdInput.addEventListener("blur", function () {
            xhr = new XMLHttpRequest();
            var formData = new FormData(document.LoginForm);
            xhr.open('POST', '/FrontUserProfile/NewUserAjax');
            xhr.send(formData);

            xhr.addEventListener('load', function () {
                var data = xhr.responseText;
                myDiv.innerHTML = `<h4 style="font-family: 微軟正黑體">` + data + "</h4>";
            })
        });


        //2.密碼驗證:密碼強度
        document.querySelector("#inputPassword").onblur = checkPwd;

        function checkPwd() {
            var thePwd = document.getElementById("inputPassword").value;
            var thesp = document.getElementById("pwdsp");
            thePwdLen = thePwd.length;
            var flag1 = false, flag2 = false;

            if (thePwd == "")
                thesp.innerHTML = `<img src="@Url.Content("/Images/Member/error.png")" />密碼不得為空白`;
            else if (thePwdLen >= 6) {
                for (var i = 0; i < thePwdLen; i++) {
                    var Pwdch = thePwd.charCodeAt(i);

                    if ((Pwdch >= 97 && Pwdch <= 122) || (Pwdch >= 65 && Pwdch <= 90)) flag1 = true;
                    else if (Pwdch >= 48 && Pwdch <= 57) flag2 = true;

                    if (flag1 && flag2) thesp.innerHTML = `<img src="@Url.Content("/Images/Member/correct.png")" />correct`;
                    else if (!flag1) thesp.innerHTML = `<img src="@Url.Content("/Images/Member/error.png")" />必須包含英文字母`;
                    else if (!flag2) thesp.innerHTML = `<img src="@Url.Content("/Images/Member/error.png")" />必須包含數字`;
                };
            } else
                thesp.innerHTML = `<img src="@Url.Content("/Images/Member/error.png")" />密碼長度必須大於6`;
        }


    </script>
}
